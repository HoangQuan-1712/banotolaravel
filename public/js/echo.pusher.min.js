// Echo và Pusher setup cho Laravel Chat
import Echo from 'https://cdn.skypack.dev/laravel-echo';
import Pusher from 'https://cdn.skypack.dev/pusher-js';

// Khởi tạo Pusher
window.Pusher = Pusher;

// Khởi tạo Echo với cấu hình từ meta tags
window.Echo = new Echo({
  broadcaster: 'pusher',
  key: document.querySelector('meta[name="pusher-key"]')?.content,
  cluster: document.querySelector('meta[name="pusher-cluster"]')?.content,
  forceTLS: document.querySelector('meta[name="pusher-scheme"]')?.content === 'https',
  encrypted: true,
  // Sử dụng cấu hình từ biến môi trường
  host: document.querySelector('meta[name="pusher-host"]')?.content,
  port: document.querySelector('meta[name="pusher-port"]')?.content || 443,
  scheme: document.querySelector('meta[name="pusher-scheme"]')?.content || 'https',
  disableStats: true,
  enabledTransports: ['ws', 'wss'],
});

console.log('Echo initialized successfully');
